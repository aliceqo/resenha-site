document.addEventListener('DOMContentLoaded', () => {
    function formatarTitulo(titulo) {
        return titulo
            .normalize('NFD') // Normaliza o texto
            .replace(/[\u0300-\u036f]/g, '') // Remove acentos
            .replace(/ /g, '-') // Substitui espaços por hifens
            .toLowerCase(); // Converte tudo para minúsculas
    }

    fetch('/back-end/pegarResenhas')
        .then(response => response.json())
        .then(resenhas => {
            resenhas.forEach(resenha => {
                // Ignorar a posição 0, já que não existe o elemento no HTML
                if (resenha.destaque_posicao === 0) {
                    console.warn('Resenha com destaque_posicao 0 ignorada.');
                    return;
                }

                const livroElemento = document.getElementById(`livro-${resenha.destaque_posicao}`);
                if (livroElemento) {
                    livroElemento.innerHTML = '';

                    const img = document.createElement('img');
                    img.src = resenha.url_foto;

                    const title = document.createElement('h3');
                    title.textContent = resenha.titulo;

                    const link = document.createElement('a');
                    link.href = `resenhas/${formatarTitulo(resenha.titulo)}.html`;
                    link.textContent = 'Ver Resenha';

                    livroElemento.appendChild(img);
                    livroElemento.appendChild(title);
                    livroElemento.appendChild(link);
                } else {
                    console.error(`Elemento com id livro-${resenha.destaque_posicao} não encontrado.`);
                }
            });
        })
        .catch(error => {
            console.error('Erro ao carregar resenhas:', error);
        });
});