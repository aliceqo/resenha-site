document.addEventListener("DOMContentLoaded", () => {
    const formAddResenha = document.getElementById("form-add-resenha");
    const formResenhaFrase = document.getElementById("resenha_frase");

    const submitButton = document.querySelector("button[type='submit']");
    
    if (submitButton) {
        submitButton.addEventListener("click", async (event) => {
            event.preventDefault(); // Evita o envio padrão do formulário

            const formData = coletarDadosFormulario();

            try {
                const response = await fetch("http://localhost:8080/back-end/adicionar", {
                    method: "POST",
                    body: formData
                });

                if (!response.ok) {
                    throw new Error("Erro ao enviar o formulário");
                }

                const result = await response.text();
                console.log(result);
                alert("Resenha adicionada com sucesso!");
                // Aqui você pode redirecionar para outra página ou limpar o formulário
            } catch (error) {
                console.error("Erro:", error);
                alert("Erro ao enviar o formulário");
            }
        });
    }
});

function coletarDadosFormulario() {
    const formResenha = document.getElementById("form-add-resenha");
    const formFrase = document.getElementById("resenha_frase");

    const formData = new FormData(formResenha);

    for (let [key, value] of new FormData(formFrase).entries()) {
        formData.append(key, value);
    }

    // Log para verificar o conteúdo do FormData
    for (let pair of formData.entries()) {
        console.log(`${pair[0]}: ${pair[1]}`);
    }

    return formData;
}
