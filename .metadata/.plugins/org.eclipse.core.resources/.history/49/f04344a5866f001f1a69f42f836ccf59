document.addEventListener('DOMContentLoaded', function () {
    const resenhaId = obterIdResenha();
    if (resenhaId) {
        console.log('ID da resenha:', resenhaId); // Depuração
        carregarDadosResenha(resenhaId);
    } else {
        console.error('ID da resenha não encontrado');
    }
});

function carregarDadosResenha(id) {
    fetch(`/excluirEditar?id=${id}`)
        .then(response => {
            if (!response.ok) {
                throw new Error(`Erro ao carregar os dados da resenha: ${response.statusText}`);
            }
            return response.json();
        })
        .then(data => {
            console.log('Dados da resenha:', data); // Depuração

            // Verifique se os elementos existem antes de definir suas propriedades
            const urlFotoElement = document.getElementById('url_foto');
            if (urlFotoElement) {
                urlFotoElement.src = data.url_foto || 'Imagem não disponível';
            } else {
                console.error('Elemento com ID urlFoto não encontrado');
            }

            const tituloElement = document.getElementById('titulo');
            if (tituloElement) {
                tituloElement.innerText = data.titulo || 'Título não encontrado';
            } else {
                console.error('Elemento com ID titulo não encontrado');
            }

            const idadeLeituraElement = document.getElementById('idade_leitura');
            if (idadeLeituraElement) {
                idadeLeituraElement.innerText = data.idade_leitura || 'Idade de leitura não encontrada';
            } else {
                console.error('Elemento com ID idadeLeitura não encontrado');
            }

            const livroElement = document.getElementById('livro');
            if (livroElement) {
                livroElement.innerText = data.livro || 'Livro não encontrado';
            } else {
                console.error('Elemento com ID livro não encontrado');
            }

            const autorElement = document.getElementById('autor');
            if (autorElement) {
                autorElement.innerText = data.autor || 'Autor não encontrado';
            } else {
                console.error('Elemento com ID autor não encontrado');
            }

            const tradutorElement = document.getElementById('tradutor');
            if (tradutorElement) {
                tradutorElement.innerText = data.tradutor || 'Tradutor não encontrado';
            } else {
                console.error('Elemento com ID tradutor não encontrado');
            }

            const generosElement = document.getElementById('generos');
            if (generosElement) {
                generosElement.innerText = data.generos || 'Gêneros não encontrados';
            } else {
                console.error('Elemento com ID generos não encontrado');
            }

            const idiomaElement = document.getElementById('idioma');
            if (idiomaElement) {
                idiomaElement.innerText = data.idioma || 'Idioma não encontrado';
            } else {
                console.error('Elemento com ID idioma não encontrado');
            }

            const editoraElement = document.getElementById('editora');
            if (editoraElement) {
                editoraElement.innerText = data.editora || 'Editora não encontrada';
            } else {
                console.error('Elemento com ID editora não encontrado');
            }

            const numeroPaginasElement = document.getElementById('numero_paginas');
            if (numeroPaginasElement) {
                numeroPaginasElement.innerText = data.numero_paginas || 'Número de páginas não encontrado';
            } else {
                console.error('Elemento com ID numeroPaginas não encontrado');
            }

            const fraseDestaqueElement = document.getElementById('frase_destaque');
            if (fraseDestaqueElement) {
                fraseDestaqueElement.innerText = data.frase_destaque || 'Frase de destaque não encontrada';
            } else {
                console.error('Elemento com ID fraseDestaque não encontrado');
            }

            const conteudoResenhaElement = document.getElementById('conteudo_resenha');
            if (conteudoResenhaElement) {
                conteudoResenhaElement.innerText = data.conteudo_resenha || 'Conteúdo da resenha não encontrado';
            } else {
                console.error('Elemento com ID conteudoResenha não encontrado');
            }
        })
        .catch(error => {
            console.error('Erro ao carregar os dados da resenha:', error);
        });
}

function obterIdResenha() {
    const params = new URLSearchParams(window.location.search);
    return params.get('id');
}





    // Enviar dados para editar uma resenha
   /* botEditarResenha.addEventListener('click', () => {
        const formData = new FormData();

        formData.append('id', document.getElementById('resenhaId').value);
        formData.append('titulo', document.getElementById('titulo').value);
        formData.append('idade_leitura', document.getElementById('idade_leitura').value);
        formData.append('livro', document.getElementById('livro').value);
        formData.append('autor', document.getElementById('autor').value);
        formData.append('tradutor', document.getElementById('tradutor').value);
        formData.append('generos', document.getElementById('generos').value);
        formData.append('idioma', document.getElementById('idioma').value);
        formData.append('editora', document.getElementById('editora').value);

        const numeroPaginas = document.getElementById('numero_paginas').value;
        const numeroPaginasNumber = parseInt(numeroPaginas, 10);
        formData.append('numero_paginas', isNaN(numeroPaginasNumber) ? 0 : numeroPaginasNumber);

        formData.append('frase_destaque', document.getElementById('frase_destaque').value);
        formData.append('conteudo_resenha', document.getElementById('resenha').value);

        const urlFotoInput = document.getElementById('url_foto');
        if (urlFotoInput && urlFotoInput.files.length > 0) {
            formData.append('url_foto', urlFotoInput.files[0]);
        }

        fetch('/back-end/excluirEditar', {
            method: 'POST',
            body: formData
        })
        .then(response => response.text())
        .then(data => {
            console.log('Resenha atualizada com sucesso:', data);
            alert('Resenha atualizada com sucesso!');
        })
        .catch(error => {
            console.error('Erro ao atualizar a resenha:', error);
            alert('Erro ao atualizar a resenha.');
        });
    });

    // Excluir uma resenha
    botExcluirResenha.addEventListener('click', () => {
        const id = document.getElementById('resenhaId').value;

        fetch(`/back-end/excluirEditar?id=${id}`, {
            method: 'DELETE'
        })
        .then(response => response.text())
        .then(data => {
            console.log('Resenha excluída com sucesso:', data);
            alert('Resenha excluída com sucesso!');
        })
        .catch(error => {
            console.error('Erro ao excluir a resenha:', error);
            alert('Erro ao excluir a resenha.');
        });
    });*/