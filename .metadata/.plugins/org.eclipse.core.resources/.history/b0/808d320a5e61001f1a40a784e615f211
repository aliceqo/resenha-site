document.getElementById('redefinirSenhaForm').addEventListener('submit', handleSubmit);

function handleSubmit(event) {
  event.preventDefault();

  const newPassword = document.getElementById('newPassword').value.trim();
  const confirmPassword = document.getElementById('confirmPassword').value.trim();

  if (newPassword !== confirmPassword) {
    displayMessage('Senhas não coincidem.', 'red');
    return;
  }

  if (newPassword.length < 8) {
    displayMessage('Senha deve ter pelo menos 8 caracteres.', 'red');
    return;
  }

  fetch('/redefinir', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/x-www-form-urlencoded'
    },
    body: `newPassword=${encodeURIComponent(newPassword)}&confirmPassword=${encodeURIComponent(confirmPassword)}`
  })
  .then(response => response.text().then(text => ({
    status: response.status,
    body: text
  })))
  .then(result => {
    if (result.status === 200) {
      displayMessage('Senha redefinida com sucesso.', 'green');
    } else {
      displayMessage(result.body, 'red');
    }
  })
  .catch(error => console.error('Erro ao fazer a requisição:', error));
}

function displayMessage(message, color) {
  const mensagemElement = document.getElementById('mensagem');
  mensagemElement.innerText = message;
  mensagemElement.style.color = color;
}