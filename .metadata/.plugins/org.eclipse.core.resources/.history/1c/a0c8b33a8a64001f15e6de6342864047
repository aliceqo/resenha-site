document.addEventListener("DOMContentLoaded", function () {
    const botEditarResenha = document.getElementById('bot-editar-resenha');
    const botExcluirResenha = document.getElementById('bot-excluir-resenha');

    // Obter o ID da URL
    const queryParams = new URLSearchParams(window.location.search);
    const resenhaId = queryParams.get('id');

    if (!resenhaId) {
        console.error('ID da resenha nÃ£o encontrado na URL.');
        return;
    }

    if (botEditarResenha) {
        botEditarResenha.addEventListener('click', function () {
            const formData = new FormData();
            formData.append('id', resenhaId);
            formData.append('titulo', document.getElementById('titulo').value);
            formData.append('imagem', document.getElementById('url_foto').files[0]);
            formData.append('idade_leitura', document.getElementById('idade_leitura').value);
            formData.append('livro', document.getElementById('livro').value);
            formData.append('autor', document.getElementById('autor').value);
            formData.append('tradutor', document.getElementById('tradutor').value);
            formData.append('generos', document.getElementById('generos').value);
            formData.append('idioma', document.getElementById('idioma').value);
            formData.append('editora', document.getElementById('editora').value);
            formData.append('numero_paginas', document.getElementById('numero_paginas').value);
            formData.append('frase_destaque', document.getElementById('frase_destaque').value);
            formData.append('conteudo_resenha', document.getElementById('resenha').value);

            fetch(`/editarResenha?id=${resenhaId}`, {
                method: 'POST',
                body: formData
            }).then(response => {
                if (response.ok) {
                    window.location.href = 'resenhas.html';
                } else {
                    alert('Erro ao atualizar a resenha.');
                }
            }).catch(error => {
                console.error('Erro:', error);
                alert('Erro ao atualizar a resenha.');
            });
        });
    }

    if (botExcluirResenha) {
        botExcluirResenha.addEventListener('click', function () {
            fetch(`/editarResenha?id=${resenhaId}`, {
                method: 'DELETE'
            }).then(response => {
                if (response.ok) {
                    window.location.href = 'resenhas.html';
                } else {
                    alert('Erro ao excluir a resenha.');
                }
            }).catch(error => {
                console.error('Erro:', error);
                alert('Erro ao excluir a resenha.');
            });
        });
    }
});
