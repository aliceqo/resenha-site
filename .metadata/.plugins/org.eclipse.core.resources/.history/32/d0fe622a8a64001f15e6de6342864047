document.addEventListener("DOMContentLoaded", function () {
    const resenhaId = new URLSearchParams(window.location.search).get('id');
    
    if (resenhaId) {
        fetch(`/editarResenha?id=${resenhaId}`)
            .then(response => response.json())
            .then(data => {
                document.getElementById('resenhaId').value = data.id;
                document.getElementById('titulo').value = data.titulo;
                document.getElementById('url_foto').value = data.url_foto;
                document.getElementById('idade_leitura').value = data.idade_leitura;
                document.getElementById('livro').value = data.livro;
                document.getElementById('autor').value = data.autor;
                document.getElementById('tradutor').value = data.tradutor;
                document.getElementById('generos').value = data.generos;
                document.getElementById('idioma').value = data.idioma;
                document.getElementById('editora').value = data.editora;
                document.getElementById('numero_paginas').value = data.numero_paginas;
                document.getElementById('frase_destaque').value = data.frase_destaque;
                document.getElementById('conteudo_resenha').value = data.conteudo_resenha;
            });
    }

    document.getElementById('bot-editar-resenha').addEventListener('click', function () {
        const form = document.getElementById('form-edit-resenha');
        const formData = new FormData(form);
        
        fetch('/editarResenha', {
            method: 'POST',
            body: formData
        }).then(response => {
            if (response.ok) {
                window.location.href = 'resenhas.html';
            } else {
                alert('Erro ao atualizar a resenha.');
            }
        });
    });

    document.getElementById('bot-excluir-resenha').addEventListener('click', function () {
        const resenhaId = document.getElementById('resenhaId').value;

        fetch(`/editarResenha?id=${resenhaId}`, {
            method: 'DELETE'
        }).then(response => {
            if (response.ok) {
                window.location.href = 'resenhas.html';
            } else {
                alert('Erro ao excluir a resenha.');
            }
        });
    });
});