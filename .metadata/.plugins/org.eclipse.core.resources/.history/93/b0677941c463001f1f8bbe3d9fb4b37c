const botAddResenha = document.getElementById("bot-add-resenha");
const botRasResenha = document.getElementById("bot-ras-resenha");
const servidorUrl = "http://localhost:8080/back-end/adicionar";

function coletarDadosFormulario() {
    const formResenha = document.getElementById("form-add-resenha");
    const formFrase = document.getElementById("resenha_frase");

    if (!formResenha || !formFrase) {
        console.error("Um ou mais formulários não foram encontrados no DOM.");
        return null;
    }

    const formData = new FormData(formResenha);
    const formDataFrase = new FormData(formFrase);

    for (let [key, value] of formDataFrase.entries()) {
        formData.append(key, value);
    }

    return formData;
}

function enviarFormulario(url) {
	console.log("enviar");
    const formData = coletarDadosFormulario();

    if (!formData) {
        console.error("Erro ao coletar dados do formulário.");
        return;
    }

    fetch(url, {
        method: "POST",
        body: formData
    })
    .then(response => {
        if (!response.ok) {
            throw new Error(`Erro ao enviar o formulário: ${response.status} ${response.statusText}`);
        }
        return response.text();
    })
    .then(data => {
        console.log("Sucesso:", data);
        window.location.href = "indexAdm.html"; // Redireciona após o envio bem-sucedido
    })
    .catch(error => {
        console.error("Erro:", error);
        alert(`Erro ao enviar o formulário: ${error.message}`);
    });
}

// Evento para o botão "Adicionar Resenha"
botAddResenha.addEventListener("click", function(event) {
    event.preventDefault(); // Evita o comportamento padrão do botão
    enviarFormulario(servidorUrl); // URL do seu Servlet
});
botRasResenha.addEventListener("click", function(event) {
    event.preventDefault(); // Evita o comportamento padrão do botão
    enviarFormulario(servidorUrl); // URL do seu Servlet
});
